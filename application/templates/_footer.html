<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script>
    var rb_root = '{{ url_for('api_refbook') }}',
        url_client_get = '{{ url_for('patients.api_patient_get') }}',
        url_client_save = '{{ url_for('patients.api_patient_save') }}',
        url_client_html = '{{ url_for('patients.patient') }}',
        url_client_search = '{{ url_for('patients.api_search_clients') }}',
        url_action_get = '{{ url_for('schedule.api_action_get') }}',
        url_action_new = '{{ url_for('schedule.api_action_new_get') }}',
        url_action_save = '{{ url_for('schedule.api_action_post') }}',
        url_event_get = '{{ url_for('event.api_event_info') }}',
        url_event_new = '{{ url_for('event.api_event_new_get') }}',
        url_event_save = '{{ url_for('event.api_event_save') }}',
        url_print_templates = '{{ print_subsystem_templates }}',
        url_print_subsystem = '{{ print_subsystem_url }}',
        url_print_template = '{{ print_subsystem_print_template }}',
        url_kladr_city_get = '{{ url_for('patients.api_kladr_city_get') }}',  // for tests
        url_kladr_street_get = '{{ url_for('patients.api_kladr_street_get') }}',  // for tests
        kladr_city = '{{ url_for('kladr_city') }}',
        kladr_street = '{{ url_for('kladr_street') }}',
        url_for_event_api_diagnosis_save = '{{ url_for('event.api_diagnosis_save') }}',
        url_for_event_api_new_event_payment_info_get = '{{ url_for('event.api_new_event_payment_info_get') }}',
        url_for_event_api_search_services = '{{ url_for('event.api_search_services') }}',
        url_for_event_api_service_delete_service = '{{ url_for('event.api_service_delete_service') }}',
        url_for_event_api_service_make_payment = '{{ url_for('event.api_service_make_payment') }}',
        url_for_event_api_service_add_coord = '{{ url_for('event.api_service_add_coord') }}',
        url_for_event_api_service_remove_coord = '{{ url_for('event.api_service_remove_coord') }}',
        url_for_schedule_api_atl_get = '{{ url_for('schedule.api_atl_get') }}',
        url_for_schedule_api_atl_get_flat = '{{ url_for('schedule.api_atl_get_flat') }}',
        url_for_event_html_event_info = '{{ url_for('event.html_event_info') }}',
        url_for_schedule_html_action = '{{ url_for('schedule.html_action') }}',
        url_event_new_event_html = '{{ url_for('event.new_event') }}',
        url_schedule_appointment_html = '{{ url_for('schedule.appointment') }}',
        url_schedule_api_appointment = '{{ url_for('schedule.api_appointment') }}',
        url_schedule_api_schedule = '{{ url_for('schedule.api_schedule') }}',
        url_schedule_api_move_client = '{{ url_for('schedule.api_move_client') }}',
        url_schedule_html_person_schedule_monthview = '{{ url_for('schedule.person_schedule_monthview') }}',
        url_schedule_api_schedule_description = '{{ url_for('schedule.api_schedule_description') }}',
        url_schedule_api_schedule_description_post = '{{ url_for('schedule.api_schedule_description_post') }}',
        url_schedule_api_schedule_lock = '{{ url_for('schedule.api_schedule_lock') }}',
        url_schedule_api_html_day_free = '{{ url_for('schedule.html_day_free') }}',
        url_schedule_all_persons_tree = '{{ url_for('schedule.api_all_persons_tree') }}',
        current_user = {{ current_user.export_js() | tojson | safe }},
        current_user_id = {{ current_user.id|default('undefined') }};
</script>
<script src="{{ url_for('static', filename='jquery-ui/js/jquery-1.10.2.js') }}"></script>

<script src="{{ url_for('static', filename='angular.js/angular-sanitize.min.js') }}"></script>
<script src="{{ url_for('static', filename='angular.js/angular-locale_ru-ru.js') }}"></script>
<script src="{{ url_for('static', filename='js/moment.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/moment.ru.js') }}"></script>

<script src="{{ url_for('static', filename='bootstrap/js/bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='angular.js/ui-bootstrap-tpls.js') }}"></script>

<script src="{{ url_for('static', filename='ckeditor/ckeditor.js') }}"></script>
<script src="{{ url_for('static', filename='ckeditor/config.js') }}"></script>
<script src="{{ url_for('static', filename='angular.js/ng-ckeditor.src.js') }}"></script>

<script src="{{ url_for('static', filename='select2/select2.js') }}"></script>
<script src="{{ url_for('static', filename='select2/select2_locale_ru.js') }}"></script>
<script src="{{ url_for('static', filename='angular-ui-select/select.js') }}"></script>
<script src="{{ url_for('static', filename='angular.js/angular-tree-repeat.js') }}"></script>
<script src="{{ url_for('static', filename='angular-ui-utils/mask_edited.js') }}"></script>
<script src="{{ url_for('static', filename='js/angular-strap.js') }}"></script>
<script src="{{ url_for('static', filename='js/angular-strap.tpl.js') }}"></script>

<script src="{{ url_for('static', filename='js/webmis20.js', v=version) }}"></script>
<script src="{{ url_for('static', filename='js/directives.js', v=version) }}"></script>
<script src="{{ url_for('static', filename='js/directives/goodies.js', v=version) }}"></script>
<script src="{{ url_for('static', filename='js/directives/person_tree.js', v=version) }}"></script>
<script src="{{ url_for('static', filename='js/directives/action-type-tree.js', v=version) }}"></script>
<script src="{{ url_for('static', filename='js/services.js', v=version) }}"></script>
<script src="{{ url_for('static', filename='js/services/appointment_dialog.js', v=version) }}"></script>
<script src="{{ url_for('static', filename='js/controllers.js', v=version) }}"></script>
<script src="{{ url_for('static', filename='js/loader.js', v=version) }}"></script>
<script type="text/ng-template" id="_timePicker.html">
    <div class="input-group">
        <input type="text" id="{{id}}" name="{{name}}" class="form-control"
               ng-model="ngModel" autocomplete="off"
               ng-required="ngRequired" show-time ng-disabled="ngDisabled"/>
        <span class="input-group-btn">
            <button class="btn btn-default" type="button" ng-click="open_timepicker_popup()" ng-disabled="ngDisabled">
                <i class="glyphicon glyphicon-time"></i>
            </button>
            <div class="timepicker_popup" ng-show="isPopupVisible">
                <div ng-model="ngModel" style="display:inline-block;">
                    <timepicker show-meridian="false"></timepicker>
                </div>
            </div>
        </span>

    </div>
</script>
<script type="text/ng-template" id="kladr-ui.html">
    {% include "kladr-ui.html" %}
</script>
<script>
    'use strict';
    current_user.has_role = function () {
        return aux.arrayCopy(arguments).filter(aux.func_in(current_user.roles)).length > 0;
    };
    current_user.has_right = function () {
        return aux.arrayCopy(arguments).filter(aux.func_in(current_user.rights)).length > 0;
    };
    current_user.current_role_maybe = function () {
        return aux.inArray(aux.arrayCopy(arguments), current_user.current_role);
    };
</script>