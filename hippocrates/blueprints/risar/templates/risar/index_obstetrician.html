{% extends 'risar/base.html' %}

{% block title %}> {{ module_name }}{% endblock %}

{% block main %}
<section class="content-header">
    <h1>Рабочий стол {% if user_profiles_mng.has_ui_obstetrician() %}акушера-гинеколога{% endif %}</h1>
</section>
<section class="content">
    <div ng-controller="IndexObstetricianCtrl" class="ng-cloak">
        <div class="row">
            <div class="col-md-12">
                <input class="form-control" ng-model="query" placeholder="Быстрый поиск" autofocus>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 text-right">
                <a href="{{ url_for('.html_search') }}">Расширенный поиск</a>
            </div>
        </div>
        <div class="row">
            <div class="col-md-9">
                {% include "risar/desktop/patient_list.html" %}
                <div class ="row">
                    <div class="col-md-6">
                        <div class="box box-info">
                            <div class="box-header">
                                <h3 class="box-title">Срочная госпитализация</h3>
                                <span class="badge label-danger">[[ need_hospitalization.length ]]</span>
                                <div class="box-tools pull-right">
                        {#            <ul class="pagination pagination-sm no-margin" style="vertical-align: middle;">#}
                        {#                <li><a href="#">«</a></li>#}
                        {#                <li><a href="#">1</a></li>#}
                        {#                <li><a href="#">2</a></li>#}
                        {#                <li><a href="#">3</a></li>#}
                        {#                <li><a href="#">»</a></li>#}
                        {#            </ul>#}
                                    <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                </div>
                            </div>
                            <div class="box-body no-padding">
                                <table class="table">
                                    <tbody>
                                    <tr>
                                        <th>Риск</th>
                                        <th>ФИО</th>
                                        <th>Срок</th>
                                    </tr>
                                    <tr ng-repeat="row in need_hospitalization | filter:query">
                                        <td><span class="label"
                                                  ng-class="{'label-default': row.risk_rate.id == 0,
                                                             'label-success': row.risk_rate.id == 1,
                                                             'label-warning': row.risk_rate.id == 2,
                                                             'label-danger': row.risk_rate.id == 3}">[[ row.risk_rate.name ]]</span></td>
                                        <td><a ng-href="{{ url_for('.html_chart') }}?event_id=[[ row.id ]]">[[
                                            row.client.full_name ]]</a></td>
                                        <td>[[ row.pregnancy_week ]]<i class="fa fa-question" ng-if="!row.pregnancy_week"></i></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="box box-info">
                            <div class="box-header">
                                <h3 class="box-title">Срочные поручения</h3>
                                <span class="badge label-info">5</span>
                                <div class="box-tools pull-right">
                        {#            <ul class="pagination pagination-sm no-margin" style="vertical-align: middle;">#}
                        {#                <li><a href="#">«</a></li>#}
                        {#                <li><a href="#">1</a></li>#}
                        {#                <li><a href="#">2</a></li>#}
                        {#                <li><a href="#">3</a></li>#}
                        {#                <li><a href="#">»</a></li>#}
                        {#            </ul>#}
                                    <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                </div>
                            </div>
                            <div class="box-body no-padding">
                                <table class="table">
                                    <tbody>
                                    <tr>
                                        <th>Номер</th>
                                        <th>Риск</th>
                                        <th>ФИО</th>
                                        <th>Статус</th>
                                    </tr>
                                    <tr>
                                        <td>12/2015</td>
                                        <td><span class="label label-danger">высокий</span></td>
                                        <td>Подшивалова Баира Петровна</td>
                                        <td><span class="label label-warning">Ожидает выполнения</span></td>
                                    </tr>
                                    <tr>
                                        <td>56/2015</td>
                                        <td><span class="label label-danger">высокий</span></td>
                                        <td>Ксантос Альбина Сергеевна</td>
                                        <td><span class="label label-danger">Просрочено</span></td>
                                    </tr>
                                    <tr>
                                        <td>33/2015</td>
                                        <td><span class="label label-danger">высокий</span></td>
                                        <td>Полякова Наталья Сергеевна</td>
                                        <td><span class="label label-warning">Ожидает выполнения</span></td>
                                    </tr>
                                    <tr>
                                        <td>78/2015</td>
                                        <td><span class="label label-warning">средний</span></td>
                                        <td>Неверова Анна Эдуардовна</td>
                                        <td><span class="label label-danger">Просрочено</span></td>
                                    </tr>
                                    <tr>
                                        <td>56/2015</td>
                                        <td><span class="label label-warning">средний</span></td>
                                        <td>Полякова Наталья Сергеевна</td>
                                        <td><span class="label label-danger">Просрочено</span></td>
                                    </tr>
                                    <tr class="text-center">
                                        <td colspan="4"><a href="#">Все поручения</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                {% include "risar/desktop/diagram_pregnancy_week.html" %}
            </div>
            <div class="col-md-3">
                <div class="box box-warning">
                    <div class="box-header with-border">
                        <h3 class="box-title">Статистика по пациенткам:</h3>
                        <div class="box-tools pull-right">
                          <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        </div>
                    </div>
                    <div class="box-body">
                        <table class="table table-condensed no-border">
                            <tr>
                                <td>Всего</td>
                                <td><span class="badge label-info pull-right">[[current_stats.events_all]]</span></td>
                            </tr>
                            <tr>
                                <td>Не закрыты карты пациенток (срок более 45 недель)</td>
                                <td><span class="badge label-danger pull-right">[[current_stats.events_45]]</span></td>
                            </tr>
                            <tr>
                                <td>Пропущено плановое посещение (2 месяца)</td>
                                <td><span class="badge label-danger pull-right">[[current_stats.events_2_months]]</span></td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="box box-warning">
                    <div class="box-header with-border">
                        <h3 class="box-title">Ведение карт</h3>
                        <div class="box-tools pull-right">
                          <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        </div>
                    </div>
                    <div class="box-body">
                        <table class="table table-condensed no-border">
                            <tr>
                                <td>Заполненные карты</td>
                                <td><span class="badge label-info pull-right">12</span></td>
                            </tr>
                            <tr>
                                <td>Незаполненные разделы</td>
                                <td><span class="badge label-danger pull-right">6</span></td>
                            </tr>
                            <tr>
                                <td>Анамнез</td>
                                <td><span class="badge label-danger pull-right">0</span></td>
                            </tr>
                            <tr>
                                <td>Плановый осмотр</td>
                                <td><span class="badge label-danger pull-right">2</span></td>
                            </tr>
                            <tr>
                                <td>ЛПУ для родоразрешения</td>
                                <td><span class="badge label-danger pull-right">1</span></td>
                            </tr>
                            <tr>
                                <td>Результаты мероприятий</td>
                                <td><span class="badge label-danger pull-right">1</span></td>
                            </tr>
                            <tr>
                                <td>Эпикриз</td>
                                <td><span class="badge label-danger pull-right">2</span></td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div class="box box-danger">
                    <div class="box-header with-border">
                        <h3 class="box-title">Пациентки по степени риска</h3>
                        <div class="box-tools pull-right">
                            <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        </div>
                    </div>
                    <div class="box-body">
                        <nvd3-pie-chart
                            id="noid"
                            data="slices"
                            width="350"
                            height="370"
                            margin="{left:0,top:0,bottom:0,right:10}"
                            x="slices_x"
                            y="slices_y"
                            color="slices_c"
                            nodata="Нет данных"
                            showlegend="true"
                            showlabels="true"
                            labeltype="value"
                            donut="true"
                            donut-ratio="0.33"
                            ><svg></svg>
                        </nvd3-pie-chart>
                    </div>
                    <div class="box-footer">
                        <h4>По патологиям</h4>
                        <ul class="nav nav-pills nav-stacked">
                            <li><a href="#">Cоматическая <span class="pull-right text-red"> 12%</span></a></li>
                            <li><a href="#">Акушерско-гинекологическая <span class="pull-right text-green"> 48%</span></a></li>
                            <li><a href="#">Сочетанная <span class="pull-right text-yellow"> 40%</span></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block modules_js %}
    {{ super() }}
    <script src="{{ url_for('.static', filename='js/index_obstetrician.js', v=version) }}"></script>
    <script src="{{ url_for('.static', filename='js/risar.js', v=version) }}"></script>
{% endblock %}





