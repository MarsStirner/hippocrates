{% extends 'risar/base/base.html' %}
{% import 'risar/_macros.html' as rimacros %}

{% block title %}> Осмотры акушером-гинекологом беременной{% endblock %}

{% block main %}
<div ng-controller="InspectionViewCtrl" ng-cloak>
    <section class="content-header">
        {{ rimacros.page_title_ext_n('Осмотры акушером-гинекологом беременной', 'inspection') }}
        <div class="novmargin">
        <div class="btn-group">
            <a ng-href="{{ url_for('.html_chart') }}?event_id=[[ header.event.id ]]" class="btn btn-default">Карта пациентки</a>
            <a ng-href="{{ url_for('.html_anamnesis') }}?event_id=[[ header.event.id ]]" class="btn btn-default">Анамнез</a>
            <a ng-href="{{ url_for('.html_inspection') }}?event_id=[[ header.event.id ]]" class="btn btn-primary">Осмотры</a>
            <a ng-href="{{ url_for('.html_routing') }}?event_id=[[ header.event.id ]]&emergency=1" class="btn btn-default">Маршрутизация</a>
            <a ng-href="{{ url_for('.html_epicrisis') }}?event_id=[[ header.event.id ]]" class="btn btn-default">Эпикриз</a>
            <a ng-class="{disabled: !ps.is_available()}" ng-click="open_print_window(ps)" class="btn btn-default">Печать</a>
            <div class="btn-group">
                <button class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Дополнительно <span class="fa fa-caret-down"></span></button>
                <ul role="menu" class="dropdown-menu">
                    <li><a ng-href="{{ url_for('.html_event_diagnoses') }}?event_id=[[ header.event.id ]]">Диагнозы случая</a></li>
                    <li><a ng-href="{{ url_for('.html_event_measure') }}?event_id=[[ header.event.id ]]">Мероприятия случая</a></li>
                </ul>
            </div>
        </div>
        </div>
    </section>
    <section class="content">
        <div class="box box-primary">
        <div class="box-body">
        <table class="table">
            <thead>
                <tr>
                    <th width="10%" nowrap>Данные осмотра <a ng-href="{{ url_for('.html_inspection_edit') }}?event_id=[[ header.event.id ]]" class="btn btn-xs btn-success" title="Добавить новый осмотр"><i class="glyphicon glyphicon-plus"></i></a></th>
                    <th width="10%" nowrap ng-repeat="checkup in checkups">
                        <a ng-href="{{ url_for('.html_inspection_read') }}?event_id=[[ header.event.id ]]&checkup_id=[[ checkup.id ]]">[[ checkup.beg_date | asDate ]]</a>
                        <div class="btn-group">
                            <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown">
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li ng-if="checkup.flat_code == 'risarFirstInspection'" ng-class="{disabled: !ps_fi.is_available()}"><a href="#" ng-click="open_print_window(ps_fi, checkup.id)" >Печать</a></li>
                                <li ng-if="checkup.flat_code == 'risarSecondInspection'" ng-class="{disabled: !ps_si.is_available()}"><a href="#" ng-click="open_print_window(ps_si, checkup.id)" >Печать</a></li>
                                <li><a href="#">Копировать</a></li>
                                <li><a href="#">Удалить</a></li>
                            </ul>
                        </div>
                    </th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th>Срок беременности (расчётный)</th>
                    <td ng-repeat="checkup in checkups">[[ checkup.pregnancy_week ]] ([[checkup.calculated_pregnancy_week]])</td>
                    <td></td>
                </tr>
                <tr>
                    <th>Диагнозы</th>
                    <td colspan="[[ checkups.length + 1 ]]"></td>
                </tr>
                <tr>
                    <td>основной</td>
                    <td ng-repeat="checkup in checkups"><span class="bottom_dotted" tooltip="[[ checkup.diag.diagnosis.mkb.name ]]">[[ checkup.diag.diagnosis.mkb.code ]]</span></td>
                    <td></td>
                </tr>
                <tr>
                    <td>сопутствующие</td>
                    <td ng-repeat="checkup in checkups"><p ng-repeat="diag in checkup.diag2"><span class="bottom_dotted" tooltip="[[ diag.diagnosis.mkb.name ]]">[[ diag.diagnosis.mkb.code ]]</span></p></td>
                    <td></td>
                </tr>
                <tr>
                    <td>осложнения</td>
                    <td ng-repeat="checkup in checkups"><p ng-repeat="diag in checkup.diag3"><span class="bottom_dotted" tooltip="[[ diag.diagnosis.mkb.name ]]">[[ diag.diagnosis.mkb.code ]]</span></p></td>
                    <td></td>
                </tr>
                <tr>
                    <th>Масса тела</th>
                    <td ng-repeat="checkup in checkups"> [[ checkup.weight ]]</td>
                    <td></td>
                </tr>
                <tr>
                    <th>Прибавка в массе</th>
                    <td ng-repeat="checkup in checkups">
                        <span tooltip="Прибавка в массе на расчётный срок [[ checkup.pregnancy_week ]] [[declOfNum(checkup.pregnancy_week, ['неделя', 'недели', 'недель'])]]">
                            [[checkup.weight-first_checkup.weight]]</span>/<span tooltip="Прибавка в массе за [[ checkup.weight_gain[1] ]] [[declOfNum(checkup.weight_gain[1], ['день', 'дня', 'дней'])]]">[[ checkup.weight_gain[0] ]]</span></td>
                    <td></td>
                </tr>
                <tr>
                    <th>Молочные железы</th>
                    <td ng-repeat="checkup in checkups"><p ng-repeat="item in checkup.breast">[[ item | format:'{name}' ]]</p></td>
                    <td></td>
                </tr>
                <tr>
                    <th>Соски</th>
                    <td ng-repeat="checkup in checkups"><p ng-repeat="item in checkup.nipples">[[ item | format:'{name}' ]]</p></td>
                    <td></td>
                </tr>
                <tr>
                    <th>Отёки</th>
                    <td ng-repeat="checkup in checkups"> [[ checkup.edema ]]</td>
                    <td></td>
                </tr>
                <tr>
                    <th>АД левая рука</th>
                    <td ng-repeat="checkup in checkups"> [[ checkup.ad_left_high ]]/[[ checkup.ad_left_low ]]</td>
                    <td></td>
                </tr>
                <tr>
                    <th>АД правая рука</th>
                    <td ng-repeat="checkup in checkups"> [[ checkup.ad_right_high ]]/[[ checkup.ad_right_low ]]</td>
                    <td></td>
                </tr>
                <tr>
                    <th>Окружность живота</th>
                    <td ng-repeat="checkup in checkups"> [[ checkup.abdominal ]]</td>
                    <td></td>
                </tr>
                <tr>
                    <th>Матка</th>
                    <td colspan="[[ checkups.length + 1 ]]"></td>
                </tr>
                <tr>
                    <td>Высота дна</td>
                    <td ng-repeat="checkup in checkups"> [[ checkup.fundal_height ]]</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Состояние</td>
                    <td ng-repeat="checkup in checkups"> [[ checkup.metra_state.name ]]</td>
                    <td></td>
                </tr>
                <tr>
                    <th>Плод</th>
                    <td colspan="[[ checkups.length + 1 ]]"></td>
                </tr>
                <tr>
                    <td>Положение</td>
                    <td ng-repeat="checkup in checkups"> [[ checkup.fetus_position.name ]]</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Предлежание</td>
                    <td ng-repeat="checkup in checkups"> [[ checkup.presenting_part.name ]]</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Характер СС</td>
                    <td ng-repeat="checkup in checkups"> [[ checkup.fetus_heartbeat.name ]]</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Частота СС</td>
                    <td ng-repeat="checkup in checkups"> [[ checkup.fetus_heart_rate ]]</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
        </div>
        </div>
    </section>
</div>
{% endblock %}

{% block modules_js %}
    {{ super() }}
    <script src="{{ url_for('.static', filename='js/chart.js', v=app_version) }}"></script>
{% endblock %}