{% extends 'risar/base/base.html' %}
{% import 'risar/_macros.html' as rimacros with context %}

{% block title %}> {{ module_name }}{% endblock %}

{% block main %}
<div ng-controller="AnamnesisFatherEditCtrl" ng-cloak>
    <section class="content-header" ng-controller="RisarHeaderCtrl">
        {{ rimacros.page_title_n('Ввод данных об отце') }}
        {{ rimacros.navigation('[[ event_id ]]') }}
    </section>
    <section class="content">
        <ng-form name="anamnesisFatherForm" id="anamnesisFatherForm" role="form" novalidate>
            <div class="box-body">
            <table class="table table-condensed">
                <thead>
                <tr>
                    <th class="col-md-4"></th>
                    <th class="col-md-8"></th>
                </tr>
                </thead>
                <tbody>
                {% if 'name' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('name')"></th>
                    <td><input ng-model="anamnesis_father.name" class="form-control" valid-regexp name-regexp autofocus
                               ng-required="fatherAnamnesisDescriptor.getMandatory('name')"
                               ng-disabled="fatherAnamnesisDescriptor.getReadOnly('name')"></td>
                </tr>
                {% endif %}
                {% if 'age' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('age')"></th>
                    <td>
                        <div class="row">
                            <div class="col-md-4">
                                <input ng-model="anamnesis_father.age" class="form-control" max="999" type="number" valid-number
                                       ng-required="fatherAnamnesisDescriptor.getMandatory('age')"
                                       ng-disabled="fatherAnamnesisDescriptor.getReadOnly('age')">
                            </div>
                        </div>
                    </td>
                </tr>
                {% endif %}
                {% if 'education' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('education')"></th>
                    <td><rb-select ng-model="anamnesis_father.education" ref-book="rbRisarEducation"
                                   ng-required="fatherAnamnesisDescriptor.getMandatory('education')"
                                   ng-disabled="fatherAnamnesisDescriptor.getReadOnly('education')"></rb-select></td>
                </tr>
                {% endif %}
                {% if 'work_group' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('work_group')"></th>
                    <td><rb-select ng-model="anamnesis_father.work_group" ref-book="rbRisarWork_Group"
                                   ng-required="fatherAnamnesisDescriptor.getMandatory('work_group')"
                                   ng-disabled="fatherAnamnesisDescriptor.getReadOnly('work_group')"></rb-select></td>
                </tr>
                {% endif %}
                {% if 'professional_properties' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('professional_properties')"></th>
                    <td><rb-select ng-model="anamnesis_father.professional_properties" ref-book="rbRisarProfessional_Properties"
                                   ng-required="fatherAnamnesisDescriptor.getMandatory('professional_properties')"
                                   ng-disabled="fatherAnamnesisDescriptor.getReadOnly('professional_properties')"></rb-select></td>
                </tr>
                {% endif %}
                {% if 'blood_type' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('blood_type')"></th>
                    <td><div class="row"><div class="col-md-4">
                        <rb-select ng-model="anamnesis_father.blood_type" ref-book="rbBloodType"
                                   ng-required="fatherAnamnesisDescriptor.getMandatory('blood_type')"
                                   ng-disabled="fatherAnamnesisDescriptor.getReadOnly('blood_type')"></rb-select></div></div></td>
                </tr>
                {% endif %}
                {% if 'phone' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('phone')"></th>
                    <td><input ng-model="anamnesis_father.phone" class="form-control"
                               ng-required="fatherAnamnesisDescriptor.getMandatory('phone')"
                               ng-disabled="fatherAnamnesisDescriptor.getReadOnly('phone')"></td>
                </tr>
                {% endif %}
                {% if 'HIV' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('HIV')"></th>
                    <td>{{ rimacros.radio_da_net(model='anamnesis_father.HIV', descriptor='fatherAnamnesisDescriptor') }}</td>
                </tr>
                {% endif %}
                {% if 'fluorography' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('fluorography')"></th>
                    <td><input ng-model="anamnesis_father.fluorography" class="form-control"
                               ng-required="fatherAnamnesisDescriptor.getMandatory('fluorography')"
                               ng-disabled="fatherAnamnesisDescriptor.getReadOnly('fluorography')"></td>
                </tr>
                {% endif %}
                {% if 'infertility' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('infertility')"></th>
                    <td>{{ rimacros.radio_da_net(model='anamnesis_father.infertility', descriptor='fatherAnamnesisDescriptor') }}</td>
                </tr>
                {% endif %}
                {% if 'infertility_type' in father_anamnesis_descriptor %}
                <tr>
                    <td class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('infertility_type')"></td>
                    <td><rb-select ref-book="rbRisarInfertility_Type" ng-model="anamnesis_father.infertility_type"
                        ng-disabled="!anamnesis_father.infertility"></rb-select></td>
                </tr>
                {% endif %}
                {% if 'infertility_period' in father_anamnesis_descriptor %}
                <tr>
                    <td class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('infertility_period')"></td>
                    <td><input ng-model="anamnesis_father.infertility_period" class="form-control" max="999" type="number" valid-number ng-disabled="!anamnesis_father.infertility"></td>
                </tr>
                {% endif %}
                {% if 'infertility_treatment' in father_anamnesis_descriptor %}
                <tr>
                    <td class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('infertility_treatment')"></td>
                    <td><rb-select multiple="true" ref-book="rbRisarFatherInfertility_Treatment" ng-model="anamnesis_father.infertility_treatment"
                        ng-disabled="!anamnesis_father.infertility"></rb-select></td>
                </tr>
                {% endif %}
                {% if 'infertility_cause' in father_anamnesis_descriptor %}
                <tr>
                    <td class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('infertility_cause')"></td>
                    <td><rb-select multiple="true" ref-book="rbRisarFatherInfertilityCauses" ng-model="anamnesis_father.infertility_cause"
                        ng-disabled="!anamnesis_father.infertility"></rb-select></td>
                </tr>
                {% endif %}
                {% if 'finished_diseases' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('finished_diseases')"></th>
                    <td><wm-mkb-multiple ng-model="anamnesis_father.finished_diseases"
                               ng-required="fatherAnamnesisDescriptor.getMandatory('finished_diseases')"
                               ng-disabled="fatherAnamnesisDescriptor.getReadOnly('finished_diseases')"></wm-mkb-multiple></td>
                </tr>
                {% endif %}
                {% if 'finished_diseases_text' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('finished_diseases_text')"></th>
                    <td><wysiwyg ng-model="anamnesis_father.finished_diseases_text" /></td>
                </tr>
                {% endif %}
                {% if 'hereditary' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('hereditary')"></th>
                    <td><rb-select multiple="true" ref-book="rbRisarHereditary" ng-model="anamnesis_father.hereditary"
                               ng-required="fatherAnamnesisDescriptor.getMandatory('hereditary')"
                               ng-disabled="fatherAnamnesisDescriptor.getReadOnly('hereditary')"></rb-select></td>
                </tr>
                    {%- if 'hereditary_defect' in father_anamnesis_descriptor -%}
                        <tr ng-if="isHeredTextVisible">
                            <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('hereditary_defect')"></th>
                            <td><wysiwyg ng-model="anamnesis_father.hereditary_defect" /></td>
                        </tr>
                    {%- endif -%}
                {% endif %}
                {% if 'hereditary_free_input' in father_anamnesis_descriptor %}
                   <tr>
                        <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('hereditary_free_input')"></th>
                        <td><wysiwyg ng-model="anamnesis_father.hereditary_free_input" /></td>
                   </tr>
                {% endif %}
                {% if 'current_diseases' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('current_diseases')"></th>
                    <td><wm-mkb-multiple ng-model="anamnesis_father.current_diseases"
                               ng-required="fatherAnamnesisDescriptor.getMandatory('current_diseases')"
                               ng-disabled="fatherAnamnesisDescriptor.getReadOnly('current_diseases')"></wm-mkb-multiple></td>
                </tr>
                {% endif %}
                {% if 'current_diseases_text' in father_anamnesis_descriptor %}
                <tr>
                    <th class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('current_diseases_text')"></th>
                    <td><wysiwyg ng-model="anamnesis_father.current_diseases_text" /></td>
                </tr>
                {% endif %}
                <tr>
                    <th class="text-right">Вредные привычки</th>
                    <td>&nbsp;</td>
                </tr>
                {% if 'alcohol' in father_anamnesis_descriptor %}
                <tr>
                    <td class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('alcohol')"></td>
                    <td>{{ rimacros.radio_da_net(model='anamnesis_father.alcohol', descriptor='fatherAnamnesisDescriptor') }}</td>
                </tr>
                {% endif %}
                {% if 'smoking' in father_anamnesis_descriptor %}
                <tr>
                    <td class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('smoking')"></td>
                    <td>{{ rimacros.radio_da_net(model='anamnesis_father.smoking', descriptor='fatherAnamnesisDescriptor') }}</td>
                </tr>
                {% endif %}
                {% if 'toxic' in father_anamnesis_descriptor %}
                <tr>
                    <td class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('toxic')"></td>
                    <td>{{ rimacros.radio_da_net(model='anamnesis_father.toxic', descriptor='fatherAnamnesisDescriptor') }}</td>
                </tr>
                {% endif %}
                {% if 'drugs' in father_anamnesis_descriptor %}
                <tr>
                    <td class="text-right" ng-bind-html="fatherAnamnesisDescriptor.getLabel('drugs')"></td>
                    <td>{{ rimacros.radio_da_net(model='anamnesis_father.drugs', descriptor='fatherAnamnesisDescriptor') }}</td>
                </tr>
                {% endif %}
                </tbody>
            </table>
            </div>
        </ng-form>
        <div class="box-footer text-right">
            <a class="pseudo-btn" ng-href="{{ url_for('.html_anamnesis') }}?event_id=[[ event_id ]]">Перейти на форму анамнеза пациентки</a>
            <button class="btn btn-success" ng-click="save()">Сохранить</button>
        </div>
    </section>
</div>
{% endblock %}

{% block modules_js %}
    {{ super() }}
    <script>
        WebMis20.value('father_anamnesis_descriptor', angular.fromJson('{{father_anamnesis_descriptor|tojson|safe}}'));
    </script>
    <script src="{{ url_for('.static', filename='js/anamnesis.js', v=app_version) }}"></script>
    <script src="{{ url_for('static', filename='js/services/event/event-services.js', v=app_version) }}"></script>
{% endblock %}