<div class="modal-header">
    <h3 class="modal-title">Сведения о переливаниях крови</h3>
</div>
<div class="modal-body">
    <ng-form name="modalForm">
    <table class="table table-condensed">
        <thead>
        <tr>
            <th class="col-md-2">Дата установления</th>
            <th class="col-md-2">Тип</th>
            <th class="col-md-3">Врач, установивший группу крови</th>
            <th class="col-md-2">Фенотип Rh</th>
            <th class="col-md-2">Kell</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="model in models">
            <td class="col-md-2" ng-if="!model.deleted"><wm-date ng-model="model.date" ng-required="true"></wm-date></td>
            <td class="col-md-2" ng-if="!model.deleted" ng-class="{'has-error': modalForm['blood_type' + $index].$invalid}">
                <rb-select id="blood_type[[$index]]" name="blood_type[[$index]]" ng-model="model.blood_type"
                           ref-book="rbBloodType" ng-required="true"></rb-select>
            </td>
            <td class="col-md-3" ng-if="!model.deleted" ng-class="{'has-error': modalForm['person' + $index].$invalid}">
                <wm-person-select id="person[[$index]]" name="person[[$index]]"
                                  ng-model="model.person" ng-required="true" placeholder="Врач">
                </wm-person-select>
            </td>
            <td class="col-md-2" ng-if="!model.deleted" ng-class="{'has-error': modalForm['blood_phenotype' + $index].$invalid}">
                <rb-select id="blood_phenotype[[$index]]" name="blood_phenotype[[$index]]" ng-model="model.blood_phenotype"
                           ref-book="rbBloodPhenotype" ng-required="true"></rb-select>
            </td>
            <td class="col-md-2" ng-if="!model.deleted" ng-class="{'has-error': modalForm['blood_kell' + $index].$invalid}">
                <rb-select id="blood_kell[[$index]]" name="blood_kell[[$index]]" ng-model="model.blood_kell"
                           ref-book="rbBloodKell" ng-required="true"></rb-select>
            </td>
        </tr>
        <tr>
            <td colspan="5"><div class="pull-right"><button class="btn btn-success" ng-click="addModel()">Добавить</button></div></td>
        </tr>
        </tbody>
    </table>
    </ng-form>
</div>
<div class="modal-footer">
    <button class="btn btn-success" ng-disabled="modalForm.$invalid" ng-click="$close(models)">Сохранить</button>
    <button class="btn btn-default" ng-click="$dismiss()">Отменить</button>
</div>